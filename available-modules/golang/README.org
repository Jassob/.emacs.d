# -*- indent-tabs-mode: nil; -*-
#+TITLE: Go module
#+AUTHOR: Jassob
#+DATE: <2018-07-28>

* About this file
  This file contains the literate source of the Go module.

* Module
  This configuration sets up a Go mode where common-code minor mode is
  enabled together with a plethora of other useful stuff, such as
  linter and formatters etc.

  #+begin_src emacs-lisp :tangle module.el
    ;; Use package defaults for these packages
    (use-package gotest :ensure t
      :config
      (setq go-test-verbose t))
    (use-package go-mode
      :init
      (setq gofmt-command "goimports")
      (add-hook 'go-mode-hook 'common-code-mode)
      (add-hook 'go-mode-hook (lambda ()
                                (add-hook 'before-save-hook 'gofmt-before-save)))
      :bind (:map go-mode-map
                  ("C-c C-r" . go-remove-unused-imports)
                  ("C-c C-f" . gofmt)
                  ("C-c C-k" . godoc))
      :config
      (if (not (string-match "go" compile-command))
          (set (make-local-variable 'compile-command)
               "go build -v && go test -v && go vet")))
  #+end_src
